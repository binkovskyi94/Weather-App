var imageName,searchMethod,cityOfCountry=document.querySelector(".card__weather-city"),transitionElem=document.querySelector(".card__weather"),notificationElement=document.querySelector(".card__weather-date"),timeImage=document.querySelector(".card__weather img"),tempElement=document.querySelector(".card__weather-temp_degrees span"),tempFeels=document.querySelector(".card__weather-temp_feels"),temperatureMax=document.querySelector(".card__weather-temp--up"),temperatureMin=document.querySelector(".card__weather-temp--down"),weatherDescription=document.querySelector(".card__weather-description p"),weatherHumidity=document.querySelector(".weather__humidity"),weatherPressure=document.querySelector(".weather__pressure"),weatherSpeedWind=document.querySelector(".weather__wind"),weatherIcon=document.querySelector(".icon_container"),date=document.querySelector(".card__weather-date"),now=new Date,KELVIN=273,key="5b1cba0a2880898d704454f00228beff";"geolocation"in navigator?navigator.geolocation.getCurrentPosition(setPosition,showError):(notificationElement.style.display="block",notificationElement.innerHTML="<p>Browser doesn't Support Geolocation</p>");var searchCityName=document.querySelector("form.search__weather-inner").addEventListener("submit",function(e){e.preventDefault();var t=document.querySelector("input").value;e.target.reset(),t?searchWeather(t):t&&(getWeather(latitude,longitude),e.preventDefault())});function setPosition(e){getWeather(e.coords.latitude,e.coords.longitude)}function showError(e){notificationElement.style.display="block",notificationElement.innerHTML="<p> ".concat(e.message,"</p>")}function getSearchMethod(e){searchMethod=5===e.length&&Number.parseInt(e)+""===e?"zip":"q"}function getWeather(e,t){fetch("http://api.openweathermap.org/data/2.5/weather?lat=".concat(e,"&lon=").concat(t,"&appid=").concat(key)).then(function(e){return e.json()}).then(function(e){return e}).then(function(e){console.log(e),transition(),weatherMain(e),weatherAPP(e)}).catch(function(e){weatherNotFound(e)})}function searchWeather(e){getSearchMethod(e),fetch("http://api.openweathermap.org/data/2.5/weather?".concat(searchMethod,"=").concat(e,"&appid=").concat(key)).then(function(e){return e.json()}).then(function(e){return e}).then(function(e){console.log(e),transition(),weatherMain(e),weatherAPP(e)}).catch(function(e){weatherNotFound(e)})}function weatherMain(e){weatherIcon.style.display="block",cityOfCountry.innerHTML="".concat(e.name,", ").concat(e.sys.country),date.innerHTML=dateBuilder(now),tempElement.innerHTML=Math.round(e.main.temp-KELVIN)+"&deg;C",tempFeels.innerHTML=Math.round(e.main.feels_like-KELVIN)+"&deg;C",temperatureMax.innerHTML=Math.round(e.main.temp_max-KELVIN)+"&deg;C",temperatureMin.innerHTML=Math.round(e.main.temp_min-KELVIN)+"&deg;C",weatherDescription.textContent=e.weather[0].description,weatherHumidity.innerHTML=e.main.humidity+"%",weatherPressure.innerHTML=Math.round(e.main.pressure/1.33)+"mm",weatherSpeedWind.innerHTML=e.wind.speed+"m/s",imageName=e.weather[0].icon}function weatherAPP(e){if(isDayTime(imageName))switch(console.log("day"),timeImage.setAttribute("src","images/content/clound sky bg-01.jpg"),date.classList.contains("text-white")?date.classList.remove("text-white"):date.classList.add("text-black"),e.weather[0].main){case"Clear":weatherIcon.innerHTML='<div class="hot"><div class="sun"></div></div>';break;case"Clouds":weatherIcon.innerHTML='<div class="cloudy"><div class="cloudD"></div></div>';break;case"Rain":case"Drizzle":case"Mist":weatherIcon.innerHTML='<div class="stormy"><div class="cloudC"></div><div class="cloudB"></div><ul><li></li><li></li><li></li><li></li><li></li></ul></div>';break;case"Thunderstorm":document.body.style.backgroundImage='url("")';break;case"Snow":weatherIcon.innerHTML='<div class="snowy"><div class="cloud"></div><div class="cloudA"></div><ul><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li></ul></div>'}else switch(console.log("night"),timeImage.setAttribute("src","images/content/night-2168868.png"),date.classList.contains("text-black")?date.classList.remove("text-black"):date.classList.add("text-white"),e.weather[0].main){case"Clear":weatherIcon.innerHTML='<div class="moon"><div class="light__moon"></div></div>';break;case"Clouds":weatherIcon.innerHTML='<div class="cloudy"><div class="cloudD"></div></div>';break;case"Rain":case"Drizzle":case"Mist":weatherIcon.innerHTML='<div class="stormy"><div class="cloudC"></div><div class="cloudB"></div><ul><li></li><li></li><li></li><li></li><li></li></ul></div>';break;case"Thunderstorm":document.body.style.backgroundImage='url("")';break;case"Snow":weatherIcon.innerHTML='<div class="snowy"><div class="cloud"></div><div class="cloudA"></div><ul><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li></ul></div>'}}function dateBuilder(e){var t=["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"][e.getDay()],n=e.getDate(),i=["January","February","March","April","May","June","July","August","September","October","November","December"][e.getMonth()],a=e.getFullYear();return"".concat(t," ").concat(n," ").concat(i," ").concat(a)}function isDayTime(e){return!!e.includes("d")}function transition(){transitionElem.classList.add("transition"),setTimeout(function(){transitionElem.classList.remove("transition")},4e3)}function weatherNotFound(e){weatherIcon.style.display="none",cityOfCountry.innerHTML="City not found",date.innerHTML="...",timeImage.setAttribute("src","images/content/sunset-1373171_1920.jpg"),tempElement.innerHTML="0&deg;C",tempFeels.innerHTML="0&deg;C",temperatureMax.innerHTML="0&deg;C",temperatureMin.innerHTML="0&deg;C",weatherDescription.textContent="...",weatherHumidity.innerHTML="0%",weatherPressure.innerHTML="0mm",weatherSpeedWind.innerHTML="0m/s",imageName=e.weather[0].icon}function themeDark(){document.getElementById("chk").addEventListener("change",function(){document.body.classList.toggle("dark")})}function dynamicInput(){var e=document.querySelector(".search-btn"),t=document.querySelector(".cancel-btn"),n=document.querySelector(".search-box"),i=document.querySelector("input");e.onclick=function(){n.classList.add("active"),i.classList.add("active"),e.classList.add("active"),t.classList.add("active")},t.onclick=function(){n.classList.remove("active"),i.classList.remove("active"),e.classList.remove("active"),t.classList.remove("active")}}themeDark(),dynamicInput();